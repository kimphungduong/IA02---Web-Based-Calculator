*{box-sizing:border-box}
:root{
  --bg: #f3f3f3; /* Nền sáng */
  --panel: #ffffff; /* Bảng điều khiển màu trắng */
  --btn: #ffffff; /* Nút số màu trắng */
  --btn-hover:#e8e8e8;
  --op:#eeeeee; /* Nút chức năng/toán tử hàng 1/2 nền xám nhạt */
  --op-hover:#dfdfdf;
  --eq:#0078d4; /* Nút = màu xanh dương */
  --eq-hover: #0063ad;
  --text:#1c1c1c; /* Chữ màu tối */
  --muted:#5c5c5c; /* Chữ mờ */
  --accent:#0078d4; /* Màu accent */
  --radius:8px; /* Giảm độ bo góc */
}
html,body{height:100%}
body{
  margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  background: var(--bg); /* Dùng nền sáng */
  color: var(--text); display:grid; place-items:center;
}
.app{
  width:min(320px, 94vw); /* Giảm chiều rộng cho gọn hơn */
  background: var(--panel);
  border:1px solid #d4d4d4;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(0,0,0,.1);
  padding: 12px;
}
.display{
  background: var(--panel);
  border-radius: var(--radius);
  padding: 10px 12px;
  min-height: 80px;
  display:flex; flex-direction:column; gap:6px;
  box-shadow: none; /* Bỏ box-shadow của display */
}
.history{
  text-align:right; color: var(--muted);
  min-height: 18px;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
  letter-spacing:.3px; font-size:.95rem;
}
.current{
  text-align:right; font-weight:600; font-size:2.2rem;
  line-height:1.2; letter-spacing:.4px; word-break:break-all;
}
.keypad{
  margin-top:10px;
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 6px; /* Giảm khoảng cách giữa các nút */
  position: relative;
}
.btn{
  padding: 12px 8px;
  background: var(--btn);
  color: var(--text);
  border: 1px solid #e0e0e0;
  border-radius: 6px; /* Giảm độ bo góc nút */
  font-size: 1.1rem;
  font-weight: 500;
  cursor: pointer;
  transition: transform .02s ease, background .15s ease;
  user-select: none;
}
.btn:active{ transform: none; box-shadow: inset 0 1px 3px rgba(0,0,0,.1) }
.btn:hover{ background: var(--btn-hover) }

/* Nút chức năng (C, CE, %, √, ±, ←) */
.btn-fn, .btn-op{
  background: var(--op);
  border-color: #d1d1d1;
  font-weight: 500;
  color: var(--text);
}
.btn-fn:hover, .btn-op:hover{ background: var(--op-hover) }

/* Nút = (Kết quả) */
.btn-eq{
  background: var(--eq);
  color: var(--panel); /* Chữ màu trắng trên nền xanh */
  border-color: var(--eq);
  font-weight: 600;
  grid-row: span 2; /* Kéo dài qua 2 hàng */
  height: 100%; /* Đảm bảo chiếm đủ chiều cao 2 hàng */
}
.btn-eq:hover{ background: var(--eq-hover); filter: none }

/* Nút 0 kéo dài */
.wide{ grid-column: span 2 }

/* Nút = ở cột cuối (cần đặt ở cuối grid) */
.wide-right{
  grid-column: 4 / 5;
  grid-row: 5 / span 2;
}

/* Loại bỏ các quy tắc cũ không dùng nữa */
.ext-left, .ext-left-2{ display: none }
/* ... (các quy tắc khác không thay đổi) */

.meta{ margin-top:10px; text-align:center; color:var(--muted); font-size:.85rem }
.meta a{ color:var(--accent); text-decoration:none }
.meta a:hover{ text-decoration:underline }

@media (max-width: 360px){
  .current{ font-size: 2rem }
}